<!doctype html><html><head>
	<title>test pwa</title>
	<meta name='viewport' content='width=device-width,initial-scale=1'/>
	<meta charset='utf-8'/>
	<base target='_blank'>
	<link rel='manifest' href='manifest.webmanifest'/>
	<link rel='icon' type='image/png' href='static/icone-192.png'/>
	<link rel='apple-touch-icon' type='image/png' href='static/icone-192.png'/>
	<meta name='msapplication-TileImage' content='static/icone-192.png'>
	<meta name='theme-color' content='ivory'/>
	<meta name='msapplication-TileColor' content='ivory'>
	<meta name='apple-mobile-web-app-capable' content='yes'>
	<meta name='apple-mobile-web-app-status-bar-style' content='black'>
	<meta name='apple-mobile-web-app-title' content='test pwa'>
	<link rel='stylesheet' type='text/css' href='static/structure.css'/>
	<link rel='stylesheet' type='text/css' href='static/perso.css'/>
	<script type='text/javascript' src='database.js'></script>
</head><body>
	<h1>ma liste de courses</h1>
	<p id='etat-connection-internet'>la connection internet</p>
	<h2>liste des messages</h2>
	<button id='install-pwa'>installer l'application</button>
	<script type='text/javascript' src='service-launcher.js'></script>
	<script type='text/javascript'>
// détecter si la connection internet est ouverte
var pConnection = document.getElementById ('etat-connection-internet');
if (window.navigator.onLine) pConnection.innerHTML = 'la connection internet est ouverte';
else pConnection.innerHTML = 'la connection internet est fermée';
window.addEventListener ('online', function(){ pConnection.innerHTML = "la connection internet vient de s'ouvrir"; });
window.addEventListener ('offline', function(){ pConnection.innerHTML = 'la connection internet vient de se fermer'; });
// échanger avec indexed-db
databaseName = 'test';
var messageList =[
	{ id: 2, etat: 'new', message: 'message b' },
	{ id: 3, etat: 'new', message: 'message c' },
	{ id: 1, etat: 'new', message: 'message a' },
	{ id: 4, etat: 'new', message: 'message d' }
]
var msgTitre = document.getElementsByTagName ('button')[0];

function printMessages (messageList){
	var msgTag = null;
	for (var m=0; m< messageList.length; m++){
		msgTag = document.createElement ('p');
		msgTag.innerHTML = messageList[m].message;
		document.body.insertBefore (msgTag, msgTitre);
}}
sendToIdb (databaseName, function(){ getFromIdb (databaseName, printMessages); }, messageList);

	</script>
</body></html>