<!DOCTYPE html><html><head>
	<title></title>
	<meta name='viewport' content='width=device-width,initial-scale=1'/>
	<meta charset='utf-8'/>
	<!--
	<base target='blank' href='../site-dp/'/>
	<link rel='icon' type='image/x-icon' href='../site-dp/data/nounours-perso.svg'/>
	<link rel='icon' type='image/svg+xml' href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='16' height='16'><circle cx='8' cy='8' r='6' style='fill:#FBD;stroke:#C36'/></svg>">
	-->
	<link rel='icon' type='image/svg+xml' href='../site-dp/data/nounours-perso.svg'/>
	<link rel='stylesheet' type='text/css' href='../site-dp/library-css/structure.css'/>
	<link rel='stylesheet' type='text/css' href='../site-dp/library-css/perso.css' media='screen'/>
<style type='text/css'>
	body {
		width: 18cm;
		padding: 50px;
	}
	p {
		width: 4em;
		height: 4em;
	/*	border-radius: 50%; */
		background-color: green;
		cursor: move;
		position: relative;
		left: 0px;
		top: 0px;
	}
</style></head><body>
	<p onmousedown='selectElement(this)'></p>
	<p class='obstacle'></p>
</body><script type='text/javascript'>
	var paragraph = document.getElementsByTagName ('p')[0];
	var currentX =0;
	var currentY =0;

	function selectElement (paragraph){
		currentX = event.screenX;
		currentY = event.screenY;
		paragraph.setAttribute ('onmousemove', 'moveElement(this)');
		paragraph.setAttribute ('onmouseup', 'deselectElement(this)');
	}
	function deselectElement (paragraph){
		paragraph.removeAttribute ('onmousemove');
		paragraph.removeAttribute ('onmouseup');
	}
	function moveElement (paragraph){
		var dx= event.screenX - currentX;
		var dy= event.screenY - currentY;
		paragraph.drag (dx, dy);
		currentX = event.screenX;
		currentY = event.screenY;
	}
	HTMLElement.prototype.drag = function (dx, dy){
		var pos = this.getPos();
		dx = pos[0] + dx;
		dy = pos[1] + dy;
		this.style.left = dx + 'px';
		this.style.top = dy + 'px';
	}
	HTMLElement.prototype.getPos = function(){
		const style = window.getComputedStyle (this);
		var dx= style.left.fromPxToNb();
		var dy= style.top.fromPxToNb();
		// v√©rifier que l'on reste dans le cadre
		const parentStyle = window.getComputedStyle (this.parentElement);
		if (dx <0) dx=0;
		else{
			const tmp = this.parentElement.clientWidth - this.offsetWidth - parentStyle.paddingRight.fromPxToNb() - parentStyle.paddingLeft.fromPxToNb();
			if (dx > tmp) dx= tmp;
		}
		if (dy <0) dy=0;
		else{
			const tmp = this.parentElement.clientHeight - this.offsetHeight - parentStyle.paddingTop.fromPxToNb() - parentStyle.paddingBottom.fromPxToNb();
			if (dy > tmp) dy= tmp;
		}
		return [ dx, dy ];
	}
	String.prototype.fromPxToNb = function(){
		// nbStr = 12px
		const nbStr = this.slice (0, -2);
		var nbInt = parseInt (nbStr);
		return nbInt;
	}
</script></html>
