<!DOCTYPE html><html><head>
	<title></title>
	<meta name='viewport' content='width=device-width,initial-scale=1'/>
	<meta charset='utf-8'/>
	<base target='_blank'>
	<link rel='icon' type='image/svg+xml' href='file:///C:/wamp64/www/site-dp/data/nounours-perso.svg'/>
	<link rel='stylesheet' type='text/css' href='file:///C:/wamp64/www/site-dp/library-css/structure.css'/>
	<link rel='stylesheet' type='text/css' href='file:///C:/wamp64/www/site-dp/library-css/perso.css' media='screen'/>
	<script type='text/javascript' src='file:///C:/wamp64/www/site-dp/library-js/drag-drop.js'></script>
<style type='text/css'>
	img, canvas, div { border-style: double; }
	div {
		padding: 0;
		line-height: 0;
		position: relative;
		background-size: contain;
		margin: 4em;
		/*
		width: 800px;
		height: 800px;
		background-image: url('file:///C:\\Users\\LENOVO\\Desktop\\images divers\\2025-05-18 tapis chinois aubusson b.jpg');
		*/
	}
	p {
		width: 2px;
		height: 100%;
		background-color: deeppink;
		display: inline-block;
		position: absolute;
		margin: 0;
		padding: 0;
		line-height: 0;
		cursor: move;
	}
	p.active { background-color: teal; }
	p:nth-child(2n){
		width: 100%;
		height: 2px;
	}
/*	p:nth-child(1){ left: 10%; }
	p:nth-child(2){ top: 10%; }
	p:nth-child(3){ right: 10%; }
	p:nth-child(4){ bottom: 10%; }
*/
</style></head><body>
	<button onclick='cropImg()'>tailler</button>
	<div><p></p><p></p><p></p><p></p></div>
</body><script type='text/javascript'>
	const imgSrc = 'file:///C:/Users/LENOVO/Desktop/images divers/2025-05-18 tapis chinois aubusson b.jpg';
	const image = new Image();
	image.src = imgSrc;
	const frame = document.getElementsByTagName ('div')[0];
	frame.style.backgroundImage = 'url("' + imgSrc +'")';
	frame.style.width = image.width /2 + 'px';
	frame.style.height = image.height /2 + 'px';
	// bouger les lignes du frame de cropping
	var movingLineX = null;
	var movingLineY = null;
	const movingLines = document.getElementsByTagName ('p');
	String.prototype.fromPx = function(){
		const nbStr = this.slice (0, -2);
		var nb = parseInt (nbStr);
		return nb;
	}
	function setMovingLinesTL(){
		movingLineX = movingLines[0];
		movingLineY = movingLines[1];
		if (""=== movingLineX.style.left) movingLineX.style.left = '0px';
		if (""=== movingLineY.style.top) movingLineY.style.top = '0px';
	}
	function setMovingLinesBR(){
		movingLineX = movingLines[2];
		movingLineY = movingLines[3];
		if (""=== movingLineX.style.left) movingLineX.style.left = '0px';
		if (""=== movingLineY.style.top) movingLineY.style.top = '0px';
	}
	movingLines[0].onmousedown = setMovingLinesTL;
	movingLines[1].onmousedown = setMovingLinesTL;
	movingLines[2].onmousedown = setMovingLinesBR;
	movingLines[3].onmousedown = setMovingLinesBR;
	frame.onclick = function (event){
		movingLineX = null;
		movingLineY = null;
	}
	document.onmousemove = function (event){
		if (movingLineX){
			console.log (movingLineX.style.left, event.clientX, frame.style.width);
			if ('-' === movingLineX.style.left[0]) movingLineX.style.left = '0px';
			else if (movingLineX.style.left.fromPx() > frame.style.width.fromPx()) movingLineX.style.left = frame.style.width;
			else movingLineX.style.left = event.clientX + 'px';
			if ('-' === movingLineY.style.top[0]) movingLineY.style.top = '0px';
			else if (movingLineY.style.top.fromPx() > frame.style.height.fromPx()) movingLineY.style.top = frame.style.height;
			else movingLineY.style.top = event.clientY + 'px';
	}}
	document.onmousemove_va = function (event){
		if (movingLineX){
			console.log (movingLineX.style.left, movingLineY.style.top);
			if (event.clientX > frame.clientWidth) movingLineX.style.left = frame.clientWidth.toString() + 'px';
			else movingLineX.style.left = event.clientX.toString() + 'px';
			if (event.clientY > frame.clientHeight) movingLineY.style.top = frame.clientHeight.toString() + 'px';
			else movingLineY.style.top = event.clientY.toString() + 'px';
	}}
	function cropImg(){
		const cropPos =[ 0,0,0,0 ];
		cropPos[0] = movingLines[0].offsetLeft - frame.offsetLeft;
		cropPos[1] = movingLines[1].offsetTop - frame.offsetTop;
		cropPos[2] = movingLines[2].offsetLeft - frame.offsetLeft;
		cropPos[3] = movingLines[3].offsetTop - frame.offsetTop;
		if (cropPos[0] > cropPos[2]){
			const tmp = cropPos[2];
			cropPos[2] = cropPos[0];
			cropPos[0] = tmp;
		}
		if (cropPos[1] > cropPos[3]){
			const tmp = cropPos[3];
			cropPos[3] = cropPos[1];
			cropPos[1] = tmp;
		}
		console.log (cropPos);
	}
</script></html>