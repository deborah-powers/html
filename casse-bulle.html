<!DOCTYPE html><html><head>
	<title>lettres en braille</title>
	<meta name='viewport' content='width=device-width,initial-scale=1'/>
	<meta charset='utf-8'/>
	<base target='blank' href='../site-dp/'/>
	<link rel='icon' type='image/svg+xml' href='data/nounours-perso.svg'/>
	<link rel='stylesheet' type='text/css' href='library-css/structure.css'/>
	<link rel='stylesheet' type='text/css' href='library-css/perso.css'/>
	<script type='text/javascript' src='library-js/popup.js'></script>
<style type='text/css'>
	section {
		display: inline-flex;
		flex-wrap: wrap;
		width: 12em;
		line-height: 0;
	}
	p {
		box-sizing: border-box;
		width: 2em;
		height: 2em;
		border-radius: 50%;
		border-width: 4px;
		border-style: solid;
		border-color: maroon;
		background-color: lightcoral;
		line-height: 0;
		margin: 0;
	}
	p.vider { border-color: blue; }
	p.rose { background-color: pink; }
	p.jaune { background-color: orange; }
	p.vert { background-color: lightgreen; }
	p.bleu { background-color: lightblue; }
</style></head><body>
	<h1>casse-bulle</h1>
	<button onclick='effacer()'>effacer</button>
	<section></section>
	<section></section>
</body>
<script type='text/javascript'>
//	console.log (document.getElementsByTagName ('p')[0].constructor.name);
const alphabet = 'abcdefghijklmnopqrstuvwxyz';
const classList =[ 'rose', 'jaune' ];
const len =6;
const len2 = len * len;
let idDelete =[];

Array.prototype.chooseRandomly = function(){
	var pos = Math.random();
	pos = pos * this.length;
	pos = Math.floor (pos);
	return this[pos];
}
HTMLElement.prototype.createBall = function (pos){
	const x= Math.floor (pos / len);
	const y= pos % len;
	var newElement = document.createElement ('p');
	newElement.className = classList.chooseRandomly();
	newElement.id = alphabet[x] + alphabet[y];
	this.appendChild (newElement);
}
HTMLElement.prototype.getByX = function (color, posX){
	// posX est une lettre, a,b,c
	var items =[];
	for (var c=0; c< this.children.length; c++)
		if (this.children[c].className === color && this.children[c].id[0] === posX)
			items.push (this.children[c]);
	return items;
}
HTMLElement.prototype.getByY = function (color, posY){
	// posX est une lettre, a,b,c
	var items =[];
	for (var c=0; c< this.children.length; c++)
		if (this.children[c].className === color && this.children[c].id[1] === posY)
			items.push (this.children[c]);
	return items;
}
HTMLElement.prototype.getByRef = function (itemRef){
	var items =[];
	for (var c=0; c< this.children.length; c++)
		if (this.children[c].className === itemRef.className && this.children[c].id !== itemRef.id
		&& (this.children[c].id[0] === itemRef.id[0] || this.children[c].id[1] === itemRef.id[1])){
			console.log ('b', c);
			items.push (this.children[c]);
		}
	return items;
}
var cadre = document.getElementsByTagName ('section')[0];
for (var c=0; c< len2; c++) cadre.createBall (c);
document.getElementsByTagName ('section')[1].innerHTML = cadre.innerHTML;

for (var c=0; c< len2; c++) cleanByRef (cadre.children[c]);

function cleanByRef (itemRef){
	// lignes verticales
	let itemsLikeFirst = cadre.getByX (itemRef.className, itemRef.id[0]);
	let nb=1;
	for (var c=1; c< itemsLikeFirst.length; c++){
		if (alphabet.includes (itemsLikeFirst[c-1].id[1] + itemsLikeFirst[c].id[1])) nb+=1;
		else if (nb>2){
			for (var e=c-nb; e<c; e++) if (! idDelete.includes (itemsLikeFirst[e].id)){
				idDelete.push (itemsLikeFirst[e].id)
				itemsLikeFirst[e].classList.add ('vider');
			}
			nb=1;
	}}
	if (nb>2) for (var e=c-nb; e<c; e++)
		if (! idDelete.includes (itemsLikeFirst[e].id)){
			idDelete.push (itemsLikeFirst[e].id)
			itemsLikeFirst[e].classList.add ('vider');
	}
	// lignes horizontales
	itemsLikeFirst = cadre.getByY (itemRef.className, itemRef.id[1]);
	nb=1;
	for (var c=1; c< itemsLikeFirst.length; c++){
		if (alphabet.includes (itemsLikeFirst[c-1].id[0] + itemsLikeFirst[c].id[0])) nb+=1;
		else if (nb>2){
			for (var e=c-nb; e<c; e++) if (! idDelete.includes (itemsLikeFirst[e].id)){
				idDelete.push (itemsLikeFirst[e].id)
				itemsLikeFirst[e].classList.add ('vider');
			}
			nb=1;
	}}
	if (nb>2) for (var e=c-nb; e<c; e++)
		if (! idDelete.includes (itemsLikeFirst[e].id)){
			idDelete.push (itemsLikeFirst[e].id)
			itemsLikeFirst[e].classList.add ('vider');
	}
}

</script></html>
